<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ”® NexusVerse Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        body { margin: 0; padding: 20px; background: linear-gradient(135deg, #0D1117 0%, #1a1a2e 50%, #16213e 100%); color: #00D4FF; font-family: 'Orbitron', monospace; min-height: 100vh; }
        .header { text-align: center; margin-bottom: 30px; }
        h1 { font-size: 3em; text-shadow: 0 0 20px #00D4FF; animation: glow 2s ease-in-out infinite alternate; margin-bottom: 10px; }
        @keyframes glow { from { text-shadow: 0 0 10px #00D4FF; } to { text-shadow: 0 0 20px #00D4FF, 0 0 30px #8B00FF; } }
        .subtitle { font-size: 1.2em; opacity: 0.8; margin-bottom: 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .stat-card { 
            background: rgba(13, 17, 23, 0.9); padding: 25px; border-radius: 15px; border: 1px solid #00D4FF; text-align: center; 
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3); transition: all 0.3s; position: relative; overflow: hidden;
        }
        .stat-card::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(139, 0, 255, 0.1), transparent); transform: rotate(45deg); transition: all 0.5s; }
        .stat-card:hover::before { top: -100%; left: -100%; }
        .stat-card:hover { transform: translateY(-10px); box-shadow: 0 0 40px #00D4FF; }
        .stat-icon { font-size: 2.5em; color: #FFD700; margin-bottom: 10px; }
        .stat-value { font-size: 2.5em; color: #FFD700; font-weight: 700; }
        .stat-label { opacity: 0.8; }
        #topChart { background: rgba(13, 17, 23, 0.9); border-radius: 10px; margin: 20px 0; padding: 10px; border: 1px solid #8B00FF; max-width: 100%; height: 300px; }
        form { 
            background: rgba(13, 17, 23, 0.9); padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 1px solid #8B00FF; 
            box-shadow: 0 0 15px rgba(139, 0, 255, 0.2); 
        }
        form h2 { margin-top: 0; color: #FFD700; text-shadow: 0 0 10px #FFD700; }
        input, select, button { 
            padding: 12px; margin: 8px 5px; border: 1px solid #00D4FF; border-radius: 8px; background: rgba(0,0,0,0.6); 
            color: #00D4FF; font-family: inherit; width: calc(100% - 20px); box-sizing: border-box; transition: all 0.3s;
        }
        input:focus, select:focus { outline: none; box-shadow: 0 0 15px #00D4FF; border-color: #8B00FF; }
        button { 
            background: linear-gradient(45deg, #8B00FF, #00D4FF); color: white; border: none; cursor: pointer; width: auto; min-width: 120px; 
            font-weight: 700; transition: all 0.3s; margin: 10px 5px 0 0;
        }
        button:hover { transform: scale(1.05); box-shadow: 0 0 20px #8B00FF; }
        .form-row { display: flex; flex-wrap: wrap; gap: 10px; }
        .nav { text-align: center; margin-top: 30px; padding: 20px; background: rgba(13, 17, 23, 0.5); border-radius: 10px; }
        a { color: #00D4FF; text-decoration: none; margin: 0 20px; font-size: 1.2em; transition: all 0.3s; display: inline-block; padding: 10px 15px; border-radius: 8px; border: 1px solid transparent; }
        a:hover { color: #FFD700; background: rgba(255, 215, 0, 0.1); border-color: #FFD700; box-shadow: 0 0 15px #FFD700; transform: scale(1.05); }
        .flash { background: rgba(0, 255, 127, 0.3); padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 5px solid #00FF7F; animation: slideIn 0.5s; }
        .flash.error { background: rgba(255, 69, 0, 0.3); border-left-color: #FF4500; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        .quote { text-align: center; font-style: italic; opacity: 0.7; margin: 20px 0; font-size: 1.1em; }
        @media (max-width: 768px) { .form-row { flex-direction: column; } .stats-grid { grid-template-columns: 1fr; } #topChart { height: 250px; } }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-crown"></i> NexusVerse Control Center</h1>
        <p class="subtitle">Overseer Mode Active â€“ Command the Empire</p>
        <p class="quote">"In the Nexus, power flows to those who seize it." â€“ Void Empress</p>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-users"></i></div>
            <div class="stat-value">{{ user_count }}</div>
            <div class="stat-label">Total Users</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-star"></i></div>
            <div class="stat-value">{{ premium_count }}</div>
            <div class="stat-label">Premium Active</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-bolt"></i></div>
            <div class="stat-value">{{ active_event }}</div>
            <div class="stat-label">Active Event</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-gift"></i></div>
            <div class="stat-value">{{ premium_today }}</div>
            <div class="stat-label">Grants Today</div>
        </div>
    </div>
    
    <canvas id="topChart" width="800" height="300"></canvas>
    
    <form method="POST" action="/grant_premium">
        <h2><i class="fas fa-gem"></i> ðŸ’Ž Grant Premium Access</h2>
        <div class="form-row">
            <input type="number" name="user_id" placeholder="User  ID (e.g., 123456789)" required aria-label="User  ID">
            <input type="number" name="duration" value="1" min="1" placeholder="Months" required aria-label="Duration (Months)">
        </div>
        <button type="submit"><i class="fas fa-unlock"></i> Activate Premium</button>
    </form>
    
    <form method="POST" action="/start_event">
        <h2><i class="fas fa-rocket"></i> ðŸŒŒ Launch Global Event</h2>
        <div class="form-row">
            <select name="event_type" aria-label="Event Type">
                <option value="double_spawn">Double Spawn (2x Rates)</option>
                <option value="meme_fest">Meme Fest (Bonus Credits)</option>
                <option value="pvp_tournament">PvP Tournament (Rewards)</option>
            </select>
            <input type="number" name="duration" value="24" min="1" placeholder="Hours" required aria-label="Duration (Hours)">
        </div>
        <button type="submit"><i class="fas fa-play"></i> Launch Event</button>
    </form>
    
    <form method="POST" action="/ban_user">
        <h2><i class="fas fa-ban"></i> ðŸ”’ Ban User (Global)</h2>
        <div class="form-row">
            <input type="number" name="user_id" placeholder="User  ID" required aria-label="User  ID">
            <input type="text" name="reason" placeholder="Reason (e.g., Spam)" required aria-label="Ban Reason">
        </div>
        <button type="submit"><i class="fas fa-lock"></i> Execute Ban</button>
    </form>
    
    <form method="POST" action="/unban_user">
        <h2><i class="fas fa-unlock-alt"></i> ðŸ”“ Unban User</h2>
        <div class="form-row">
            <input type="number" name="user_id" placeholder="User  ID" required aria-label="User  ID">
        </div>
        <button type="submit"><i class="fas fa-check"></i> Lift Ban</button>
    </form>
    
    <div class="nav">
        <a href="/view_audits"><i class="fas fa-file-alt"></i> View Audits</a>
        <a href="/top_users"><i class="fas fa-trophy"></i> Top Users</a>
        <a href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>
    
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <div class="flash {{ 'error' if 'error' in message.lower() or 'denied' in message.lower() else '' }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    
    <script>
        // Render Top Users Chart (Neon Cyberpunk Style)
        const ctx = document.getElementById('topChart').getContext('2d');
        const chartData = {{ chart_data | safe }};
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: chartData.labels,
                datasets: [{
                    label: 'Levels',
                    data: chartData.levels,
                    borderColor: '#00D4FF',
                    backgroundColor: 'rgba(0, 212, 255, 0.1)',
                    tension: 0.4,
                    fill: true
                }, {
                    label: 'Credits',
                    data: chartData.credits,
                    borderColor: '#FFD700',
                    backgroundColor: 'rgba(255, 215, 0, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                scales: { y: { beginAtZero: true, grid: { color: '#8B00FF' }, ticks: { color: '#00D4FF' } }, x: { grid: { color: '#8B00FF' }, ticks: { color: '#00D4FF' } } },
                plugins: { legend: { labels: { color: '#00D4FF', font: { family: 'Orbitron' } } } },
                animation: { duration: 2000, easing: 'easeInOutQuart' }
            }
        });
        
        // Auto-refresh stats every 30s (optional live feel)
        setInterval(() => location.reload(), 30000);
    </script>
</body>
</html>